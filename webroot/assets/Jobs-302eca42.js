import{_ as Ce,P as we,r as i,c as j,aa as ve,T as b,U as W,W as s,t,az as be,av as ye,af as q,a0 as I,a7 as le,a5 as oe,V as Ye,a2 as y,a1 as z,X as p,a9 as ke,Z as x,a4 as E,ae as fe,aw as B,$ as ce,N as Y,bI as Ke,ab as je,ac as Ie,bJ as Ge,p as Oe,ah as ie,v as Xe,m as Qe,ai as Ze,w as ea,x as aa,bK as ta,l as la,y as sa,am as na,n as oa,L as ia,at as ua,F as ra,E as da,aM as va,s as fa,G as Ve,u as ca,bL as ue,A as J,q as ma,bM as _e,aG as he,Q as pa,R as ga,Y as re}from"./index-3d67980b.js";import{V as ba,a as xe,b as me,c as pe}from"./VWindowItem-230656b3.js";import{f as Pe,e as Le}from"./VForm-b7059ea1.js";import{a as Se}from"./VDivider-2601e143.js";import{V as N}from"./VHover-8e9f2939.js";import{V as ya,a as ka,b as Va}from"./VLocaleProvider-ead7e190.js";import{a as _a}from"./VTextarea-6ee8b6c6.js";import{J as ha}from"./JobCard-5b75f83c.js";const S=e=>(je("data-v-7d730705"),e=e(),Ie(),e),xa=S(()=>p("canvas",{id:"imageCanvas",style:{display:"none"}},null,-1)),Pa={style:{display:"flex","flex-direction":"column","align-items":"center",gap:"10px"}},La=S(()=>p("h4",{class:"pl-1"},"Mikä on työn otsikko? *",-1)),Sa=S(()=>p("span",{class:"pl-1"},"Esim. Lastenhoitaja tai Nurmikonleikkaaja",-1)),Ca=S(()=>p("h4",{class:"pl-1"},"Milloin työt alkavat? *",-1)),wa=S(()=>p("h4",{class:"pl-1"},"Mikä on kohde alueesi? *",-1)),ja=S(()=>p("span",{class:"pl-1"},"Esim. Suomi tai Helsinki, Suomi",-1)),Ia=S(()=>p("h4",{class:"pl-1"},"Mikä on työsopimuksen tyyppi?",-1)),Ta=S(()=>p("h4",{class:"pl-1"},"Mikä on työn kesto?",-1)),$a=S(()=>p("span",{class:"pl-1"},"Jätä tyhjäksi jos ei tiedossa",-1)),Aa=S(()=>p("h4",{class:"pl-1"},"Mikä on palkan tyyppi?",-1)),Ma=S(()=>p("span",{class:"pl-1"},"Jätä määrä tyhjäksi jos ei tiedossa",-1)),Da={__name:"AddJob",emits:["close"],setup(e,{emit:A}){const c=we(),P=i(!1),o=i(null),g=j(()=>o.value?ve(o.value).format("DD.MM.YYYY"):null),C=i(null),M=i(new Date().toISOString().substr(0,10)),w=i(null),T=i(null),D=i(null),$=i(null),m=i(null),u=i(null),r=i("one"),K=i(null),G=i(null),_=i(null),O=i([]),X=i(!1),Q=i(0),L=i(0),se=["Sopimuksen mukaan","Tarkka päivämäärä"],de=["Keikkatyö","Vakituinen","Toistaiseksi voimassa oleva"],n=["Tuntipalkka","Urakkapalkka"],d=i(40),f=i(2e3),k=i(3e3),V=i(0),F=i(n[0]),$e=j(()=>[...O.value]),Ae=[v=>v?!0:"Syötä otsikko"],Me=[v=>v?!0:"Syötä päivämäärä"],Z=[v=>{let a="Syötä arvo",l=!1;return l=!0,v&&(l=!0),parseFloat(v)<=0&&(l=!1,a="Anna arvo isompi kuin 0"),l?!0:a}],De=[v=>{let a="Kuvauksen täytyy olla vähintään 20 merkkiä",l=!1;return v&&(l=!0),v&&v.replace(/\s/g,"").length<20&&(l=!1),l?!0:a}],ee=i([]),ae=i([]);function Fe(v){const a=v.target.files[0];if(a)if(a.type.startsWith("image/")&&!a.type.startsWith("image/gif")){var l=new FileReader;l.onload=function(h){const H=new Image;H.onload=()=>{let R=H.width,U=H.height;(R>1920||U>1080)&&(R/1920>U/1080?(U*=1920/R,R=1920):(R*=1080/U,U=1080));const te=document.getElementById("imageCanvas"),ze=te.getContext("2d");te.width=R,te.height=U,ze.drawImage(H,0,0,R,U);const Ee=te.toDataURL("image/jpeg",.8);ae.value.push(Ee),te.toBlob(He=>{const qe=new File([He],a.name,{type:a.type});ee.value.push(qe)},a.type,.8)},H.src=h.target.result},l.readAsDataURL(a)}else c.snackbarText="Valitse kuva tiedostotyyppi",c.snackbarColor="red-darken-2",c.snackbar=!0}function Re(){m.value.validate().then(v=>{if(v.valid){const a={title:w.value,description:u.value,address:G.value,image_count:ee.value.length,images:ee.value};T.value&&(a.duration=T.value),ve(o.value).isValid()&&(a.date=ve(o.value).format("YYYY-MM-DD HH:mm:ss")),$.value&&(a.full_salary=$.value),c.loading=!0,c.addJob(a).then(l=>{ne()}).catch(()=>{})}})}function Ue(){P.value=!1,o.value=C.value}function Be(v){D.value&&($.value=v*D.value)}function ge(v){r.value=v}function ne(){A("close")}function Je(){K.value.click()}function Ne(v){ae.value=ae.value.filter((a,l)=>l!==v),ee.value=ee.value.filter((a,l)=>l!==v)}function We(){let v=null;O.value=[],setTimeout(()=>{v=_.value},100),setTimeout(()=>{_.value&&_.value.length>2&&v===_.value&&(X.value=!0,c.getAddressSuggestions(_.value).then(a=>{O.value=a.suggestions,X.value=!1}))},500)}return(v,a)=>(b(),W(Le,{"max-width":"700px",persistent:""},{default:s(()=>[t(oe,null,{default:s(()=>[t(be,null,{default:s(()=>[t(ba,{modelValue:r.value,"onUpdate:modelValue":a[22]||(a[22]=l=>r.value=l)},{default:s(()=>[t(xe,{value:"one"},{default:s(()=>[t(Pe,{onSubmit:a[1]||(a[1]=ye(l=>ge("two"),["prevent"]))},{default:s(()=>[t(q,null,{default:s(()=>[t(Se,{style:{height:"440px"},justify:"center",align:"center"},{default:s(()=>[(b(!0),I(z,null,le(ae.value,(l,h)=>(b(),W(N,{key:h,class:"d-flex child-flex",cols:"4"},{default:s(()=>[t(oe,{elevation:"8",width:"180"},{default:s(()=>[t(Ye,{src:l||"#",alt:"your image",cover:"","aspect-ratio":"1"},null,8,["src"]),t(y,{class:"close-btn",icon:"mdi-delete",elevation:"8",size:"35",onClick:H=>Ne(h)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128)),xa,ae.value.length<=5?(b(),W(N,{key:0,class:"d-flex child-flex",cols:"4"},{default:s(()=>[t(oe,{elevation:"8",width:"180",height:"180"},{default:s(()=>[p("input",{type:"file",ref_key:"fileInput",ref:K,onChange:Fe,style:{display:"none"},id:"customFileInput"},null,544),t(y,{onClick:Je,icon:"mdi-plus",flat:"",id:"add-img-btn",class:"text-none"},{default:s(()=>[p("div",Pa,[t(ke,{style:{"font-size":"35px"}}),x(" Lisää kuva ")])]),_:1})]),_:1})]),_:1})):E("",!0)]),_:1})]),_:1}),t(fe,null,{default:s(()=>[t(N,{class:"d-flex justify-space-between"},{default:s(()=>[t(y,{onClick:a[0]||(a[0]=l=>ne()),class:"text-none"},{default:s(()=>[x("Peruuta")]),_:1}),t(y,{color:"primary",type:"submit",class:"text-none"},{default:s(()=>[x("Seuraava")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(xe,{value:"two"},{default:s(()=>[t(Pe,{onSubmit:ye(Re,["prevent"]),ref_key:"jobForm",ref:m},{default:s(()=>[t(q,null,{default:s(()=>[La,Sa,t(B,{modelValue:w.value,"onUpdate:modelValue":a[2]||(a[2]=l=>w.value=l),label:"Työn otsikko",rules:Ae,required:""},null,8,["modelValue"])]),_:1}),t(q,null,{default:s(()=>[Ca,t(me,{mandatory:"","selected-class":"text-primary",column:"",modelValue:Q.value,"onUpdate:modelValue":a[3]||(a[3]=l=>Q.value=l)},{default:s(()=>[(b(),I(z,null,le(se,(l,h)=>t(pe,{key:h},{default:s(()=>[x(ce(l),1)]),_:2},1024)),64))]),_:1},8,["modelValue"]),Q.value==1?(b(),W(Le,{key:0,modelValue:P.value,"onUpdate:modelValue":a[8]||(a[8]=l=>P.value=l),"max-width":"400"},{activator:s(({on:l})=>[t(B,Y({modelValue:g.value,"onUpdate:modelValue":a[4]||(a[4]=h=>g.value=h),label:"Päivä",readonly:""},Ke(l),{"onUpdate:focused":a[5]||(a[5]=h=>P.value=!0),rules:Me,required:""}),null,16,["modelValue"])]),default:s(()=>[t(oe,null,{default:s(()=>[t(be,null,{default:s(()=>[t(ya,{locale:"fi"},{default:s(()=>[t(ka,{modelValue:C.value,"onUpdate:modelValue":a[6]||(a[6]=l=>C.value=l),"hide-actions":"",min:M.value,title:"Valitse päivämäärä"},null,8,["modelValue","min"])]),_:1})]),_:1}),t(fe,{style:{direction:"rtl"}},{default:s(()=>[t(y,{flat:"",onClick:Ue},{default:s(()=>[x("OK")]),_:1}),t(y,{flat:"",onClick:a[7]||(a[7]=l=>P.value=!1)},{default:s(()=>[x("Peruuta")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])):E("",!0)]),_:1}),t(q,null,{default:s(()=>[wa,ja,t(Va,{label:"Alue",items:$e.value,"onUpdate:search":[a[9]||(a[9]=l=>We()),a[10]||(a[10]=l=>_.value=l)],"hide-no-data":"",search:_.value,modelValue:G.value,"onUpdate:modelValue":a[11]||(a[11]=l=>G.value=l),"auto-select-first":"",clearable:"",loading:X.value,multiple:"",chips:""},null,8,["items","search","modelValue","loading"])]),_:1}),t(q,null,{default:s(()=>[Ia,t(me,{mandatory:"","selected-class":"text-primary",column:"",modelValue:L.value,"onUpdate:modelValue":a[12]||(a[12]=l=>L.value=l)},{default:s(()=>[(b(),I(z,null,le(de,(l,h)=>t(pe,{key:h},{default:s(()=>[x(ce(l),1)]),_:2},1024)),64))]),_:1},8,["modelValue"]),L.value==0?(b(),I(z,{key:0},[Ta,$a,t(B,{label:"kesto",suffix:"h",type:"number",modelValue:T.value,"onUpdate:modelValue":[a[13]||(a[13]=l=>T.value=l),Be],min:"0",rules:Z},null,8,["modelValue"]),Aa,Ma,t(me,{mandatory:"","selected-class":"text-primary",column:"",modelValue:V.value,"onUpdate:modelValue":a[14]||(a[14]=l=>V.value=l)},{default:s(()=>[(b(),I(z,null,le(n,(l,h)=>t(pe,{key:h},{default:s(()=>[x(ce(l),1)]),_:2},1024)),64))]),_:1},8,["modelValue"]),t(B,{label:n[V.value],suffix:V.value==0?"€/h":"€",type:"number",modelValue:F.value,"onUpdate:modelValue":a[15]||(a[15]=l=>F.value=l),min:"0",rules:Z},null,8,["label","suffix","modelValue"])],64)):(b(),W(Se,{key:1},{default:s(()=>[t(N,{cols:"4"},{default:s(()=>[t(B,{label:"Tunteja viikossa",suffix:"h",type:"number",modelValue:d.value,"onUpdate:modelValue":a[16]||(a[16]=l=>d.value=l),min:"0",rules:Z},null,8,["modelValue"])]),_:1}),t(N,{cols:"4"},{default:s(()=>[t(B,{label:"Palkan alaraja / kk",suffix:"€",type:"number",modelValue:f.value,"onUpdate:modelValue":a[17]||(a[17]=l=>f.value=l),min:"0",rules:Z},null,8,["modelValue"])]),_:1}),t(N,{cols:"4"},{default:s(()=>[t(B,{label:"Palkan yläraja / kk",suffix:"€",type:"number",modelValue:k.value,"onUpdate:modelValue":a[18]||(a[18]=l=>k.value=l),min:"0",rules:Z},null,8,["modelValue"])]),_:1})]),_:1}))]),_:1}),t(q,null,{default:s(()=>[t(_a,{label:"Kuvaus",rules:De,required:"",modelValue:u.value,"onUpdate:modelValue":a[19]||(a[19]=l=>u.value=l)},null,8,["modelValue"])]),_:1}),t(fe,null,{default:s(()=>[t(N,{class:"d-flex justify-space-between"},{default:s(()=>[t(y,{onClick:a[20]||(a[20]=l=>ne()),class:"text-none"},{default:s(()=>[x("Peruuta")]),_:1}),p("div",null,[t(y,{onClick:a[21]||(a[21]=l=>ge("one")),class:"text-none"},{default:s(()=>[x("Takaisin")]),_:1}),t(y,{color:"primary",type:"submit",class:"text-none"},{default:s(()=>[x("Luo ilmoitus")]),_:1})])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(y,{icon:"",onClick:a[23]||(a[23]=l=>ne()),class:"dialog-close-btn",flat:""},{default:s(()=>[t(ke,null,{default:s(()=>[x("mdi-close")]),_:1})]),_:1})]),_:1})]),_:1}))}},Fa=Ce(Da,[["__scopeId","data-v-7d730705"]]);function Ra(){const e=i([]);Ge(()=>e.value=[]);function A(c,P){e.value[P]=c}return{refs:e,updateRef:A}}const Ua=Oe({activeColor:String,start:{type:[Number,String],default:1},modelValue:{type:Number,default:e=>e.start},disabled:Boolean,length:{type:[Number,String],default:1,validator:e=>e%1===0},totalVisible:[Number,String],firstIcon:{type:ie,default:"$first"},prevIcon:{type:ie,default:"$prev"},nextIcon:{type:ie,default:"$next"},lastIcon:{type:ie,default:"$last"},ariaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.root"},pageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.page"},currentPageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.currentPage"},firstAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.first"},previousAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.previous"},nextAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.next"},lastAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.last"},ellipsis:{type:String,default:"..."},showFirstLastPage:Boolean,...Xe(),...Qe(),...Ze(),...ea(),...aa(),...ta(),...la({tag:"nav"}),...sa(),...na({variant:"text"})},"VPagination"),Ba=oa()({name:"VPagination",props:Ua(),emits:{"update:modelValue":e=>!0,first:e=>!0,prev:e=>!0,next:e=>!0,last:e=>!0},setup(e,A){let{slots:c,emit:P}=A;const o=ia(e,"modelValue"),{t:g,n:C}=ua(),{isRtl:M}=ra(),{themeClasses:w}=da(e),{width:T}=va(),D=fa(-1);Ve(void 0,{scoped:!0});const{resizeRef:$}=ca(n=>{if(!n.length)return;const{target:d,contentRect:f}=n[0],k=d.querySelector(".v-pagination__list > *");if(!k)return;const V=f.width,F=k.offsetWidth+parseFloat(getComputedStyle(k).marginRight)*2;D.value=K(V,F)}),m=j(()=>parseInt(e.length,10)),u=j(()=>parseInt(e.start,10)),r=j(()=>e.totalVisible!=null?parseInt(e.totalVisible,10):D.value>=0?D.value:K(T.value,58));function K(n,d){const f=e.showFirstLastPage?5:3;return Math.max(0,Math.floor(+((n-d*f)/d).toFixed(2)))}const G=j(()=>{if(m.value<=0||isNaN(m.value)||m.value>Number.MAX_SAFE_INTEGER)return[];if(r.value<=0)return[];if(r.value===1)return[o.value];if(m.value<=r.value)return ue(m.value,u.value);const n=r.value%2===0,d=n?r.value/2:Math.floor(r.value/2),f=n?d:d+1,k=m.value-d;if(f-o.value>=0)return[...ue(Math.max(1,r.value-1),u.value),e.ellipsis,m.value];if(o.value-k>=(n?1:0)){const V=r.value-1,F=m.value-V+u.value;return[u.value,e.ellipsis,...ue(V,F)]}else{const V=Math.max(1,r.value-3),F=V===1?o.value:o.value-Math.ceil(V/2)+u.value;return[u.value,e.ellipsis,...ue(V,F),e.ellipsis,m.value]}});function _(n,d,f){n.preventDefault(),o.value=d,f&&P(f,d)}const{refs:O,updateRef:X}=Ra();Ve({VPaginationBtn:{color:J(e,"color"),border:J(e,"border"),density:J(e,"density"),size:J(e,"size"),variant:J(e,"variant"),rounded:J(e,"rounded"),elevation:J(e,"elevation")}});const Q=j(()=>G.value.map((n,d)=>{const f=k=>X(k,d);if(typeof n=="string")return{isActive:!1,key:`ellipsis-${d}`,page:n,props:{ref:f,ellipsis:!0,icon:!0,disabled:!0}};{const k=n===o.value;return{isActive:k,key:n,page:C(n),props:{ref:f,ellipsis:!1,icon:!0,disabled:!!e.disabled||+e.length<2,color:k?e.activeColor:e.color,ariaCurrent:k,ariaLabel:g(k?e.currentPageAriaLabel:e.pageAriaLabel,n),onClick:V=>_(V,n)}}}})),L=j(()=>{const n=!!e.disabled||o.value<=u.value,d=!!e.disabled||o.value>=u.value+m.value-1;return{first:e.showFirstLastPage?{icon:M.value?e.lastIcon:e.firstIcon,onClick:f=>_(f,u.value,"first"),disabled:n,ariaLabel:g(e.firstAriaLabel),ariaDisabled:n}:void 0,prev:{icon:M.value?e.nextIcon:e.prevIcon,onClick:f=>_(f,o.value-1,"prev"),disabled:n,ariaLabel:g(e.previousAriaLabel),ariaDisabled:n},next:{icon:M.value?e.prevIcon:e.nextIcon,onClick:f=>_(f,o.value+1,"next"),disabled:d,ariaLabel:g(e.nextAriaLabel),ariaDisabled:d},last:e.showFirstLastPage?{icon:M.value?e.firstIcon:e.lastIcon,onClick:f=>_(f,u.value+m.value-1,"last"),disabled:d,ariaLabel:g(e.lastAriaLabel),ariaDisabled:d}:void 0}});function se(){var d;const n=o.value-u.value;(d=O.value[n])==null||d.$el.focus()}function de(n){n.key===_e.left&&!e.disabled&&o.value>+e.start?(o.value=o.value-1,he(se)):n.key===_e.right&&!e.disabled&&o.value<u.value+m.value-1&&(o.value=o.value+1,he(se))}return ma(()=>t(e.tag,{ref:$,class:["v-pagination",w.value,e.class],style:e.style,role:"navigation","aria-label":g(e.ariaLabel),onKeydown:de,"data-test":"v-pagination-root"},{default:()=>[t("ul",{class:"v-pagination__list"},[e.showFirstLastPage&&t("li",{key:"first",class:"v-pagination__first","data-test":"v-pagination-first"},[c.first?c.first(L.value.first):t(y,Y({_as:"VPaginationBtn"},L.value.first),null)]),t("li",{key:"prev",class:"v-pagination__prev","data-test":"v-pagination-prev"},[c.prev?c.prev(L.value.prev):t(y,Y({_as:"VPaginationBtn"},L.value.prev),null)]),Q.value.map((n,d)=>t("li",{key:n.key,class:["v-pagination__item",{"v-pagination__item--is-active":n.isActive}],"data-test":"v-pagination-item"},[c.item?c.item(n):t(y,Y({_as:"VPaginationBtn"},n.props),{default:()=>[n.page]})])),t("li",{key:"next",class:"v-pagination__next","data-test":"v-pagination-next"},[c.next?c.next(L.value.next):t(y,Y({_as:"VPaginationBtn"},L.value.next),null)]),e.showFirstLastPage&&t("li",{key:"last",class:"v-pagination__last","data-test":"v-pagination-last"},[c.last?c.last(L.value.last):t(y,Y({_as:"VPaginationBtn"},L.value.last),null)])])]})),{}}}),Te=e=>(je("data-v-c1e81bb1"),e=e(),Ie(),e),Ja={class:"content"},Na=Te(()=>p("div",{class:"top-layout"},null,-1)),Wa={key:0,class:"loading-container"},za={key:0,class:"error-container"},Ea=Te(()=>p("span",null,"Töiden haussa tapahtui virhe",-1)),Ha={id:"jobs-container"},qa={key:1,class:"pagination-container"},Ya={__name:"Jobs",setup(e){window.scrollTo(0,0);const A=pa(),P=ga().query,o=we(),g=i(!1),C=i(!1);g.value=!0,o.jobParams.page=P.p??1,o.jobParams.limit=P.l??10;const M=j(()=>Math.ceil(o.jobParams.totalCount/o.jobParams.limit)),w=i(!1);i(!1);const T=j(()=>({p:o.jobParams.page,l:o.jobParams.limit}));i(null),A.replace({query:T.value});function D(){window.scrollTo(0,0),A.replace({query:T.value}),$()}function $(){C.value=!1,g.value=!0;const m=300;let u=!1,r=!1;setTimeout(()=>{u=!0,r&&(g.value=!1)},m),o.fetchJobs().then(()=>{r=!0,u&&(g.value=!1)}).catch(()=>{o.errorToast("Töiden haussa tapahtui virhe"),g.value=!1,C.value=!0})}return $(),(m,u)=>(b(),I(z,null,[p("div",Ja,[Na,C.value?(b(),I("div",Wa,[C.value?(b(),I("div",za,[Ea,t(y,{"prepend-icon":"mdi-refresh",onClick:u[0]||(u[0]=r=>$())},{default:s(()=>[x(" Päivitä työt ")]),_:1})])):E("",!0)])):E("",!0),p("div",Ha,[!g.value||re(o).jobs.length>0?(b(!0),I(z,{key:0},le(re(o).jobs,r=>(b(),W(ha,{key:r.id,job:r},null,8,["job"]))),128)):E("",!0)]),g.value?E("",!0):(b(),I("div",qa,[t(Ba,{modelValue:re(o).jobParams.page,"onUpdate:modelValue":[u[1]||(u[1]=r=>re(o).jobParams.page=r),u[2]||(u[2]=r=>D())],length:M.value,"total-visible":7},null,8,["modelValue","length"])]))]),w.value?(b(),W(Fa,{key:0,modelValue:w.value,"onUpdate:modelValue":u[3]||(u[3]=r=>w.value=r),onClose:u[4]||(u[4]=r=>w.value=!1)},null,8,["modelValue"])):E("",!0)],64))}},st=Ce(Ya,[["__scopeId","data-v-c1e81bb1"]]);export{st as default};
