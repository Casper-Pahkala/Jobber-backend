import{a8 as ke,aa as Ve,a9 as be,r as i,c as se,K as _e,ad as r,ae as y,ag as m,ah as T,af as t,ax as w,ai as C,aj as p,t as l,Q as f,Z as b,as as xe,ak as o,aq as F,ao as G,V as Te,aO as we,a7 as Ce,a5 as je,al as Se,aN as j,am as M,N as Ue,bO as Ie,aP as De,aw as Fe,at as Re,au as $e}from"./index-65320579.js";import{a as Q,b as J,c as N,V as Ae}from"./VWindowItem-d64aca6f.js";import{g as Le,h as Me,f as Je}from"./VForm-6b719f59.js";import{b as Ne,V as Pe,a as We}from"./VLocaleProvider-07537e0a.js";import{b as ze}from"./VTextarea-853dfe08.js";import"./VDivider-af327986.js";const d=R=>(Re("data-v-cf0c886c"),R=R(),$e(),R),He=d(()=>o("h1",{class:"title pb-5"},"Luo listaus",-1)),Ke={class:"content"},Be=d(()=>o("canvas",{id:"imageCanvas",style:{display:"none"}},null,-1)),Ee={style:{display:"flex","flex-direction":"column","align-items":"center",gap:"10px"}},qe={class:"actions"},Oe=d(()=>o("div",{class:"title"},[o("h2",null,"Tiedot")],-1)),Ye={class:"content"},Ge=d(()=>o("h4",{class:"pl-1"},"Mikä on työn otsikko? *",-1)),Qe=d(()=>o("span",{class:"pl-1"},"Esim. Lastenhoitaja tai Nurmikonleikkaaja",-1)),Xe=d(()=>o("h4",{class:"pl-1"},"Mikä on kohde alueesi? *",-1)),Ze=d(()=>o("span",{class:"pl-1"},"Esim. Suomi tai Helsinki, Suomi",-1)),ea={class:"actions"},aa=d(()=>o("div",{class:"title"},[o("h2",null,"Tiedot")],-1)),la={class:"content"},ta=d(()=>o("h4",{class:"pl-1"},"Milloin työt alkavat? *",-1)),sa=d(()=>o("h4",{class:"pl-1"},"Mikä on työsopimuksen tyyppi?",-1)),oa=d(()=>o("h4",{class:"pl-1"},"Mikä on työn kesto?",-1)),na=d(()=>o("span",{class:"pl-1"},"Jätä tyhjäksi jos ei tiedossa",-1)),ua=d(()=>o("h4",{class:"pl-1"},"Mikä on palkan tyyppi?",-1)),ia=d(()=>o("span",{class:"pl-1"},"Jätä tyhjäksi jos ei tiedossa",-1)),da=d(()=>o("h4",{class:"pl-1"},"Paljonko tunteja viikossa?",-1)),ra=d(()=>o("span",{class:"pl-1"},"Jätä tyhjäksi jos ei tiedossa",-1)),ma=d(()=>o("h4",{class:"pl-1"},"Mikä on palkan tyyppi?",-1)),pa=d(()=>o("span",{class:"pl-1"},"Jätä tyhjäksi jos ei tiedossa",-1)),ca={class:"actions"},va={key:1,class:"login-container"},fa={__name:"AddJob",setup(R){const oe=Ve(),n=be(),v=i([]),P=i([]),X=i(null),W=i("one"),ne=["Sopimuksen mukaan","Tarkka päivämäärä"],ue=["Keikkatyö","Vakituinen","Toistaiseksi voimassa oleva"],Z=["Tuntipalkka","Urakkapalkka"],ee=["Tuntipalkka","Kuukausipalkka"],z=i(""),$=i([]),h=i(""),H=i(!1),K=i([]),B=i(""),S=i(!1),A=i(0),L=i(null),ae=se(()=>L.value?xe(L.value).format("DD.MM.YYYY"):null),E=i(null),U=i(0),q=i(null),g=i(0),O=i(null),k=i(null),ie=se(()=>{if(v.value.length===0)return!0;let s=!0;return v.value.forEach(e=>{e.ready||(s=!1)}),s?(console.log("uploaded all"),!0):!1});_e($,async(s,e)=>{s.length>e.length&&(h.value="")});function de(){S.value=!1,L.value=E.value}function re(){X.value.click()}function me(s){v.value=v.value.filter((e,a)=>a!==s),P.value=P.value.filter((e,a)=>a!==s)}function pe(s){const e=s.target.files[0];if(e)if(e.type.startsWith("image/")&&!e.type.startsWith("image/gif")){var a=new FileReader;a.onload=function(u){const c=new Image;c.onload=()=>{let _=c.width,x=c.height;(_>1920||x>1080)&&(_/1920>x/1080?(x*=1920/_,_=1920):(_*=1080/x,x=1080));const D=document.getElementById("imageCanvas"),ge=D.getContext("2d");D.width=_,D.height=x,ge.drawImage(c,0,0,_,x);const ye=D.toDataURL("image/jpeg",.8);v.value.push({image:ye,progress:10,ready:!1}),D.toBlob(te=>{const he=new File([te],e.name,{type:"image/jpeg"});P.value.push(he),ce(te)},"image/jpeg",.8)},c.src=u.target.result},a.readAsDataURL(e)}else n.snackbarText="Valitse kuva tiedostotyyppi",n.snackbarColor="red-darken-2",n.snackbar=!0}function ce(s){const e=new XMLHttpRequest,a=new FormData;a.append("image",s);let u=v.value.length-1;u<0&&(u=0);const c=v.value[u];e.upload.addEventListener("progress",V=>{if(V.lengthComputable){const Y=V.loaded/V.total*100;c.progress=Y,Y>=100&&setTimeout(()=>{c.ready=!0},1e3)}}),e.open("POST",`${n.url}/api/jobs/upload-image.json`,!0),e.onreadystatechange=function(){if(e.readyState==4&&e.status==200)try{const V=JSON.parse(e.responseText).data;c.id=V.image_id,console.log(c)}catch(V){console.error("Error parsing response:",V)}},e.send(a)}function I(s){W.value=s}function ve(){let s=null;K.value=[],setTimeout(()=>{s=h.value},100),setTimeout(()=>{h.value&&h.value.length>0&&s===h.value&&(H.value=!0,n.getAddressSuggestions(h.value).then(e=>{K.value=e.suggestions,H.value=!1}))},500)}function fe(){n.loading=!0;let s={title:z.value,area:$.value,description:B.value,images:v.value.map(e=>e.id),date:A.value===1?L.value:null,contract_type:U.value,salary_type:g.value,salary:k.value};U.value===0?s.hours=q.value:s.hours=O.value,n.addJob(s).then(e=>{oe.replace("/jobs/"+e.job_id)}).catch(()=>{})}function le(){var s=parseFloat(k.value);isNaN(s)?k.value="":k.value=s.toFixed(2)}return(s,e)=>(r(),y(b,null,[m(n).user?(r(),T(w,{key:0,class:"add-container"},{default:t(()=>[He,l(Ae,{modelValue:W.value,"onUpdate:modelValue":e[25]||(e[25]=a=>W.value=a),class:"main-window",disabled:""},{default:t(()=>[l(Q,{value:"one",class:"window"},{default:t(()=>[o("div",Ke,[l(Le,{justify:"center",align:"center",class:"images"},{default:t(()=>[(r(!0),y(b,null,F(v.value,(a,u)=>(r(),T(G,{key:u,elevation:"8",class:"image-card"},{default:t(()=>[l(Te,{src:a?a.image:"#",alt:"your image",cover:"","aspect-ratio":"1"},null,8,["src"]),a.ready?(r(),T(f,{key:0,class:"close-btn",icon:"mdi-delete",elevation:"8",size:"35",style:we(m(n).lightTheme?"color: rgb(25, 25, 25);":"color: rgb(220, 220, 220);"),onClick:c=>me(u)},null,8,["style","onClick"])):C("",!0),a.ready?C("",!0):(r(),T(Ce,{key:1,class:"progress-bar","model-value":a.progress,color:"primary"},null,8,["model-value"]))]),_:2},1024))),128)),Be,v.value.length<8?(r(),T(G,{key:0,elevation:"8",class:"image-card"},{default:t(()=>[o("input",{type:"file",ref_key:"fileInput",ref:X,onChange:pe,style:{display:"none"},id:"customFileInput"},null,544),l(f,{onClick:re,icon:"mdi-plus",flat:"",id:"add-img-btn",class:"text-none image-card"},{default:t(()=>[o("div",Ee,[l(je,{style:{"font-size":"35px"}}),p(" Lisää kuva ")])]),_:1})]),_:1})):C("",!0)]),_:1})]),o("div",qe,[l(f,{color:"primary",class:"text-none","append-icon":"mdi-chevron-right",style:{float:"right"},onClick:e[0]||(e[0]=a=>I("two")),disabled:!ie.value},{default:t(()=>[p("Seuraava")]),_:1},8,["disabled"])])]),_:1}),l(Q,{value:"two",class:"window"},{default:t(()=>[Oe,o("div",Ye,[l(Me,{onSubmit:e[6]||(e[6]=Se(a=>I("three"),["prevent"])),ref:"jobForm"},{default:t(()=>[l(w,null,{default:t(()=>[Ge,Qe,l(j,{modelValue:z.value,"onUpdate:modelValue":e[1]||(e[1]=a=>z.value=a),label:"Työn otsikko",rules:s.jobTitleRules,required:"",theme:m(n).theme},null,8,["modelValue","rules","theme"])]),_:1}),l(w,null,{default:t(()=>[Xe,Ze,l(Ne,{label:"Alue",items:K.value,"onUpdate:search":[e[2]||(e[2]=a=>ve()),e[3]||(e[3]=a=>h.value=a)],"hide-no-data":"",search:h.value,modelValue:$.value,"onUpdate:modelValue":e[4]||(e[4]=a=>$.value=a),"auto-select-first":"",clearable:"",loading:H.value,multiple:"",chips:"","closable-chips":"","no-data-text":"Aluetta ei löytynyt",theme:m(n).theme},null,8,["items","search","modelValue","loading","theme"])]),_:1}),l(w,null,{default:t(()=>[l(ze,{label:"Kuvaus",rules:s.descriptionRules,required:"",modelValue:B.value,"onUpdate:modelValue":e[5]||(e[5]=a=>B.value=a),"no-resize":""},null,8,["rules","modelValue"])]),_:1})]),_:1},512)]),o("div",ea,[l(f,{onClick:e[7]||(e[7]=a=>I("one")),class:"back-btn text-none",color:m(n).lightTheme?"grey-lighten-3":"grey-darken-3"},{default:t(()=>[p("Takaisin")]),_:1},8,["color"]),l(f,{color:"primary",type:"submit",class:"text-none",onClick:e[8]||(e[8]=a=>I("three")),"append-icon":"mdi-chevron-right"},{default:t(()=>[p("Seuraava")]),_:1})])]),_:1}),l(Q,{value:"three",class:"window"},{default:t(()=>[aa,o("div",la,[l(w,null,{default:t(()=>[ta,l(J,{mandatory:"","selected-class":"text-primary",column:"",modelValue:A.value,"onUpdate:modelValue":e[9]||(e[9]=a=>A.value=a)},{default:t(()=>[(r(),y(b,null,F(ne,(a,u)=>l(N,{key:u},{default:t(()=>[p(M(a),1)]),_:2},1024)),64))]),_:1},8,["modelValue"]),A.value==1?(r(),T(Je,{key:0,modelValue:S.value,"onUpdate:modelValue":e[14]||(e[14]=a=>S.value=a),"max-width":"400"},{activator:t(({on:a})=>[l(j,Ue({modelValue:ae.value,"onUpdate:modelValue":e[10]||(e[10]=u=>ae.value=u),label:"Päivä",readonly:""},Ie(a),{"onUpdate:focused":e[11]||(e[11]=u=>S.value=!0),rules:s.jobDateRules,required:"",theme:m(n).theme}),null,16,["modelValue","rules","theme"])]),default:t(()=>[l(G,{theme:m(n).theme},{default:t(()=>[l(De,null,{default:t(()=>[l(Pe,{locale:"fi"},{default:t(()=>[l(We,{modelValue:E.value,"onUpdate:modelValue":e[12]||(e[12]=a=>E.value=a),"hide-actions":"",min:s.minDate,title:"Valitse päivämäärä"},null,8,["modelValue","min"])]),_:1})]),_:1}),l(Fe,{style:{direction:"rtl"}},{default:t(()=>[l(f,{flat:"",onClick:de},{default:t(()=>[p("OK")]),_:1}),l(f,{flat:"",onClick:e[13]||(e[13]=a=>S.value=!1)},{default:t(()=>[p("Peruuta")]),_:1})]),_:1})]),_:1},8,["theme"])]),_:1},8,["modelValue"])):C("",!0)]),_:1}),l(w,null,{default:t(()=>[sa,l(J,{mandatory:"","selected-class":"text-primary",column:"",modelValue:U.value,"onUpdate:modelValue":e[15]||(e[15]=a=>U.value=a)},{default:t(()=>[(r(),y(b,null,F(ue,(a,u)=>l(N,{key:u},{default:t(()=>[p(M(a),1)]),_:2},1024)),64))]),_:1},8,["modelValue"]),U.value==0?(r(),y(b,{key:0},[oa,na,l(j,{label:"kesto",suffix:"h",type:"number",modelValue:q.value,"onUpdate:modelValue":[e[16]||(e[16]=a=>q.value=a),s.estimatedTimeUpdated],min:"0",rules:s.numberRules,theme:m(n).theme},null,8,["modelValue","onUpdate:modelValue","rules","theme"]),ua,ia,l(J,{mandatory:"","selected-class":"text-primary",column:"",modelValue:g.value,"onUpdate:modelValue":e[17]||(e[17]=a=>g.value=a)},{default:t(()=>[(r(),y(b,null,F(Z,(a,u)=>l(N,{key:u},{default:t(()=>[p(M(a),1)]),_:2},1024)),64))]),_:1},8,["modelValue"]),l(j,{label:Z[g.value],suffix:g.value==0?"€/h":"€",type:"number",modelValue:k.value,"onUpdate:modelValue":e[18]||(e[18]=a=>k.value=a),min:"0",onChange:e[19]||(e[19]=a=>le()),rules:s.numberRules,theme:m(n).theme},null,8,["label","suffix","modelValue","rules","theme"])],64)):(r(),y(b,{key:1},[da,ra,l(j,{label:"Tunteja viikossa",suffix:"h",type:"number",modelValue:O.value,"onUpdate:modelValue":e[20]||(e[20]=a=>O.value=a),min:"0",rules:s.numberRules,theme:m(n).theme},null,8,["modelValue","rules","theme"]),ma,pa,l(J,{mandatory:"","selected-class":"text-primary",column:"",modelValue:g.value,"onUpdate:modelValue":e[21]||(e[21]=a=>g.value=a)},{default:t(()=>[(r(),y(b,null,F(ee,(a,u)=>l(N,{key:u},{default:t(()=>[p(M(a),1)]),_:2},1024)),64))]),_:1},8,["modelValue"]),l(j,{label:ee[g.value],suffix:g.value==0?"€/h":"€/kk",type:"number",modelValue:k.value,"onUpdate:modelValue":e[22]||(e[22]=a=>k.value=a),min:"0",rules:s.numberRules,onChange:e[23]||(e[23]=a=>le()),theme:m(n).theme},null,8,["label","suffix","modelValue","rules","theme"])],64))]),_:1})]),o("div",ca,[l(f,{onClick:e[24]||(e[24]=a=>I("two")),class:"back-btn text-none",color:m(n).lightTheme?"grey-lighten-3":"grey-darken-3"},{default:t(()=>[p("Takaisin")]),_:1},8,["color"]),l(f,{color:"primary",class:"text-none","append-icon":"mdi-chevron-right",style:{float:"right"},onClick:fe},{default:t(()=>[p("Luo listaus")]),_:1})])]),_:1})]),_:1},8,["modelValue"])]),_:1})):C("",!0),m(n).user?C("",!0):(r(),y("div",va,[p(" Kirjaudu sisään niin pääset lisäämään listauksen "),l(f,{class:"mt-7",size:"large",color:"primary",onClick:e[26]||(e[26]=a=>m(n).loginDialogShowing=!0)},{default:t(()=>[p(" Kirjaudu ")]),_:1})]))],64))}},_a=ke(fa,[["__scopeId","data-v-cf0c886c"]]);export{_a as default};
