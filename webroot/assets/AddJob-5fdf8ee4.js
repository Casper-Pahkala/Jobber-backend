import{a8 as he,aa as Ve,a9 as _e,r as u,c as se,K as be,ad as d,ae as g,ag as O,ah as x,af as t,ax as w,ai as T,aj as r,t as l,Q as c,Z as V,as as xe,ak as o,aq as D,ao as G,V as we,a7 as Te,a5 as Ce,al as je,aN as C,am as J,N as Se,bP as Ue,aP as Ie,aw as De,at as Fe,au as Re}from"./index-0ea08868.js";import{a as Q,b as L,c as M,V as $e}from"./VWindowItem-0ff62a24.js";import{a as Ae}from"./VDivider-1fa0efd1.js";import{g as Je,f as Le}from"./VForm-a10f2873.js";import{b as Me,V as Pe,a as Ne}from"./VLocaleProvider-529e2914.js";import{b as We}from"./VTextarea-613f7f24.js";const i=F=>(Fe("data-v-95702c33"),F=F(),Re(),F),Ke=i(()=>o("h1",{class:"pb-5"},"Luo listaus",-1)),He=i(()=>o("div",{class:"title"},[o("h2",null,"Kuvat")],-1)),ze={class:"content"},Be=i(()=>o("canvas",{id:"imageCanvas",style:{display:"none"}},null,-1)),Ee={style:{display:"flex","flex-direction":"column","align-items":"center",gap:"10px"}},qe={class:"actions"},Ye=i(()=>o("div",{class:"title"},[o("h2",null,"Tiedot")],-1)),Oe={class:"content"},Ge=i(()=>o("h4",{class:"pl-1"},"Mikä on työn otsikko? *",-1)),Qe=i(()=>o("span",{class:"pl-1"},"Esim. Lastenhoitaja tai Nurmikonleikkaaja",-1)),Xe=i(()=>o("h4",{class:"pl-1"},"Mikä on kohde alueesi? *",-1)),Ze=i(()=>o("span",{class:"pl-1"},"Esim. Suomi tai Helsinki, Suomi",-1)),ea={class:"actions"},aa=i(()=>o("div",{class:"title"},[o("h2",null,"Tiedot")],-1)),la={class:"content"},ta=i(()=>o("h4",{class:"pl-1"},"Milloin työt alkavat? *",-1)),sa=i(()=>o("h4",{class:"pl-1"},"Mikä on työsopimuksen tyyppi?",-1)),oa=i(()=>o("h4",{class:"pl-1"},"Mikä on työn kesto?",-1)),na=i(()=>o("span",{class:"pl-1"},"Jätä tyhjäksi jos ei tiedossa",-1)),ua=i(()=>o("h4",{class:"pl-1"},"Mikä on palkan tyyppi?",-1)),ia=i(()=>o("span",{class:"pl-1"},"Jätä tyhjäksi jos ei tiedossa",-1)),da=i(()=>o("h4",{class:"pl-1"},"Paljonko tunteja viikossa?",-1)),ra=i(()=>o("span",{class:"pl-1"},"Jätä tyhjäksi jos ei tiedossa",-1)),ma=i(()=>o("h4",{class:"pl-1"},"Mikä on palkan tyyppi?",-1)),pa=i(()=>o("span",{class:"pl-1"},"Jätä tyhjäksi jos ei tiedossa",-1)),va={class:"actions"},ca={key:1,class:"login-container"},fa={__name:"AddJob",setup(F){const oe=Ve(),p=_e(),v=u([]),P=u([]),X=u(null),N=u("one"),ne=["Sopimuksen mukaan","Tarkka päivämäärä"],ue=["Keikkatyö","Vakituinen","Toistaiseksi voimassa oleva"],Z=["Tuntipalkka","Urakkapalkka"],ee=["Tuntipalkka","Kuukausipalkka"],W=u(""),R=u([]),y=u(""),K=u(!1),H=u([]),z=u(""),j=u(!1),$=u(0),A=u(null),ae=se(()=>A.value?xe(A.value).format("DD.MM.YYYY"):null),B=u(null),S=u(0),E=u(null),f=u(0),q=u(null),k=u(null),ie=se(()=>{if(v.value.length===0)return!0;let s=!0;return v.value.forEach(e=>{e.ready||(s=!1)}),s?(console.log("uploaded all"),!0):!1});be(R,async(s,e)=>{s.length>e.length&&(y.value="")});function de(){j.value=!1,A.value=B.value}function re(){X.value.click()}function me(s){v.value=v.value.filter((e,a)=>a!==s),P.value=P.value.filter((e,a)=>a!==s)}function pe(s){const e=s.target.files[0];if(e)if(e.type.startsWith("image/")&&!e.type.startsWith("image/gif")){var a=new FileReader;a.onload=function(n){const m=new Image;m.onload=()=>{let _=m.width,b=m.height;(_>1920||b>1080)&&(_/1920>b/1080?(b*=1920/_,_=1920):(_*=1080/b,b=1080));const I=document.getElementById("imageCanvas"),ge=I.getContext("2d");I.width=_,I.height=b,ge.drawImage(m,0,0,_,b);const ye=I.toDataURL("image/jpeg",.8);v.value.push({image:ye,progress:10,ready:!1}),I.toBlob(te=>{const ke=new File([te],e.name,{type:"image/jpeg"});P.value.push(ke),ve(te)},"image/jpeg",.8)},m.src=n.target.result},a.readAsDataURL(e)}else p.snackbarText="Valitse kuva tiedostotyyppi",p.snackbarColor="red-darken-2",p.snackbar=!0}function ve(s){const e=new XMLHttpRequest,a=new FormData;a.append("image",s);let n=v.value.length-1;n<0&&(n=0);const m=v.value[n];e.upload.addEventListener("progress",h=>{if(h.lengthComputable){const Y=h.loaded/h.total*100;m.progress=Y,Y>=100&&setTimeout(()=>{m.ready=!0},1e3)}}),e.open("POST",`${p.url}/api/jobs/upload-image.json`,!0),e.onreadystatechange=function(){if(e.readyState==4&&e.status==200)try{const h=JSON.parse(e.responseText).data;m.id=h.image_id,console.log(m)}catch(h){console.error("Error parsing response:",h)}},e.send(a)}function U(s){N.value=s}function ce(){let s=null;H.value=[],setTimeout(()=>{s=y.value},100),setTimeout(()=>{y.value&&y.value.length>0&&s===y.value&&(K.value=!0,p.getAddressSuggestions(y.value).then(e=>{H.value=e.suggestions,K.value=!1}))},500)}function fe(){p.loading=!0;let s={title:W.value,area:R.value,description:z.value,images:v.value.map(e=>e.id),date:$.value===1?A.value:null,contract_type:S.value,salary_type:f.value,salary:k.value};S.value===0?s.hours=E.value:s.hours=q.value,p.addJob(s).then(e=>{oe.replace("/jobs/"+e.job_id)}).catch(()=>{})}function le(){var s=parseFloat(k.value);isNaN(s)?k.value="":k.value=s.toFixed(2)}return(s,e)=>(d(),g(V,null,[O(p).user?(d(),x(w,{key:0,class:"add-container pa-10"},{default:t(()=>[Ke,l($e,{modelValue:N.value,"onUpdate:modelValue":e[25]||(e[25]=a=>N.value=a),class:"main-window"},{default:t(()=>[l(Q,{value:"one",class:"window"},{default:t(()=>[He,o("div",ze,[l(Ae,{justify:"center",align:"center",class:"images mt-10"},{default:t(()=>[(d(!0),g(V,null,D(v.value,(a,n)=>(d(),x(G,{key:n,elevation:"8",width:"180",class:"image-card"},{default:t(()=>[l(we,{src:a?a.image:"#",alt:"your image",cover:"","aspect-ratio":"1"},null,8,["src"]),a.ready?(d(),x(c,{key:0,class:"close-btn",icon:"mdi-delete",elevation:"8",size:"35",onClick:m=>me(n)},null,8,["onClick"])):T("",!0),a.ready?T("",!0):(d(),x(Te,{key:1,class:"progress-bar","model-value":a.progress,color:"primary"},null,8,["model-value"]))]),_:2},1024))),128)),Be,v.value.length<8?(d(),x(G,{key:0,elevation:"8",width:"180",height:"180",class:"image-card"},{default:t(()=>[o("input",{type:"file",ref_key:"fileInput",ref:X,onChange:pe,style:{display:"none"},id:"customFileInput"},null,544),l(c,{onClick:re,icon:"mdi-plus",flat:"",id:"add-img-btn",class:"text-none image-card"},{default:t(()=>[o("div",Ee,[l(Ce,{style:{"font-size":"35px"}}),r(" Lisää kuva ")])]),_:1})]),_:1})):T("",!0)]),_:1})]),o("div",qe,[l(c,{color:"primary",class:"text-none","append-icon":"mdi-chevron-right",style:{float:"right"},onClick:e[0]||(e[0]=a=>U("two")),disabled:!ie.value},{default:t(()=>[r("Seuraava")]),_:1},8,["disabled"])])]),_:1}),l(Q,{value:"two",class:"window"},{default:t(()=>[Ye,o("div",Oe,[l(Je,{onSubmit:e[6]||(e[6]=je(a=>U("three"),["prevent"])),ref:"jobForm"},{default:t(()=>[l(w,null,{default:t(()=>[Ge,Qe,l(C,{modelValue:W.value,"onUpdate:modelValue":e[1]||(e[1]=a=>W.value=a),label:"Työn otsikko",rules:s.jobTitleRules,required:""},null,8,["modelValue","rules"])]),_:1}),l(w,null,{default:t(()=>[Xe,Ze,l(Me,{label:"Alue",items:H.value,"onUpdate:search":[e[2]||(e[2]=a=>ce()),e[3]||(e[3]=a=>y.value=a)],"hide-no-data":"",search:y.value,modelValue:R.value,"onUpdate:modelValue":e[4]||(e[4]=a=>R.value=a),"auto-select-first":"",clearable:"",loading:K.value,multiple:"",chips:"","closable-chips":"","no-data-text":"Aluetta ei löytynyt"},null,8,["items","search","modelValue","loading"])]),_:1}),l(w,null,{default:t(()=>[l(We,{label:"Kuvaus",rules:s.descriptionRules,required:"",modelValue:z.value,"onUpdate:modelValue":e[5]||(e[5]=a=>z.value=a),"no-resize":""},null,8,["rules","modelValue"])]),_:1})]),_:1},512)]),o("div",ea,[l(c,{onClick:e[7]||(e[7]=a=>U("one")),class:"back-btn text-none"},{default:t(()=>[r("Takaisin")]),_:1}),l(c,{color:"primary",type:"submit",class:"text-none",onClick:e[8]||(e[8]=a=>U("three")),"append-icon":"mdi-chevron-right"},{default:t(()=>[r("Seuraava")]),_:1})])]),_:1}),l(Q,{value:"three",class:"window"},{default:t(()=>[aa,o("div",la,[l(w,null,{default:t(()=>[ta,l(L,{mandatory:"","selected-class":"text-primary",column:"",modelValue:$.value,"onUpdate:modelValue":e[9]||(e[9]=a=>$.value=a)},{default:t(()=>[(d(),g(V,null,D(ne,(a,n)=>l(M,{key:n},{default:t(()=>[r(J(a),1)]),_:2},1024)),64))]),_:1},8,["modelValue"]),$.value==1?(d(),x(Le,{key:0,modelValue:j.value,"onUpdate:modelValue":e[14]||(e[14]=a=>j.value=a),"max-width":"400"},{activator:t(({on:a})=>[l(C,Se({modelValue:ae.value,"onUpdate:modelValue":e[10]||(e[10]=n=>ae.value=n),label:"Päivä",readonly:""},Ue(a),{"onUpdate:focused":e[11]||(e[11]=n=>j.value=!0),rules:s.jobDateRules,required:""}),null,16,["modelValue","rules"])]),default:t(()=>[l(G,null,{default:t(()=>[l(Ie,null,{default:t(()=>[l(Pe,{locale:"fi"},{default:t(()=>[l(Ne,{modelValue:B.value,"onUpdate:modelValue":e[12]||(e[12]=a=>B.value=a),"hide-actions":"",min:s.minDate,title:"Valitse päivämäärä"},null,8,["modelValue","min"])]),_:1})]),_:1}),l(De,{style:{direction:"rtl"}},{default:t(()=>[l(c,{flat:"",onClick:de},{default:t(()=>[r("OK")]),_:1}),l(c,{flat:"",onClick:e[13]||(e[13]=a=>j.value=!1)},{default:t(()=>[r("Peruuta")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])):T("",!0)]),_:1}),l(w,null,{default:t(()=>[sa,l(L,{mandatory:"","selected-class":"text-primary",column:"",modelValue:S.value,"onUpdate:modelValue":e[15]||(e[15]=a=>S.value=a)},{default:t(()=>[(d(),g(V,null,D(ue,(a,n)=>l(M,{key:n},{default:t(()=>[r(J(a),1)]),_:2},1024)),64))]),_:1},8,["modelValue"]),S.value==0?(d(),g(V,{key:0},[oa,na,l(C,{label:"kesto",suffix:"h",type:"number",modelValue:E.value,"onUpdate:modelValue":[e[16]||(e[16]=a=>E.value=a),s.estimatedTimeUpdated],min:"0",rules:s.numberRules},null,8,["modelValue","onUpdate:modelValue","rules"]),ua,ia,l(L,{mandatory:"","selected-class":"text-primary",column:"",modelValue:f.value,"onUpdate:modelValue":e[17]||(e[17]=a=>f.value=a)},{default:t(()=>[(d(),g(V,null,D(Z,(a,n)=>l(M,{key:n},{default:t(()=>[r(J(a),1)]),_:2},1024)),64))]),_:1},8,["modelValue"]),l(C,{label:Z[f.value],suffix:f.value==0?"€/h":"€",type:"number",modelValue:k.value,"onUpdate:modelValue":e[18]||(e[18]=a=>k.value=a),min:"0",onChange:e[19]||(e[19]=a=>le()),rules:s.numberRules},null,8,["label","suffix","modelValue","rules"])],64)):(d(),g(V,{key:1},[da,ra,l(C,{label:"Tunteja viikossa",suffix:"h",type:"number",modelValue:q.value,"onUpdate:modelValue":e[20]||(e[20]=a=>q.value=a),min:"0",rules:s.numberRules},null,8,["modelValue","rules"]),ma,pa,l(L,{mandatory:"","selected-class":"text-primary",column:"",modelValue:f.value,"onUpdate:modelValue":e[21]||(e[21]=a=>f.value=a)},{default:t(()=>[(d(),g(V,null,D(ee,(a,n)=>l(M,{key:n},{default:t(()=>[r(J(a),1)]),_:2},1024)),64))]),_:1},8,["modelValue"]),l(C,{label:ee[f.value],suffix:f.value==0?"€/h":"€/kk",type:"number",modelValue:k.value,"onUpdate:modelValue":e[22]||(e[22]=a=>k.value=a),min:"0",rules:s.numberRules,onChange:e[23]||(e[23]=a=>le())},null,8,["label","suffix","modelValue","rules"])],64))]),_:1})]),o("div",va,[l(c,{onClick:e[24]||(e[24]=a=>U("two")),class:"back-btn text-none"},{default:t(()=>[r("Takaisin")]),_:1}),l(c,{color:"primary",class:"text-none","append-icon":"mdi-chevron-right",style:{float:"right"},onClick:fe},{default:t(()=>[r("Luo listaus")]),_:1})])]),_:1})]),_:1},8,["modelValue"])]),_:1})):T("",!0),O(p).user?T("",!0):(d(),g("div",ca,[r(" Kirjaudu sisään niin pääset lisäämään listauksen "),l(c,{class:"mt-7",size:"large",color:"primary",onClick:e[26]||(e[26]=a=>O(p).loginDialogShowing=!0)},{default:t(()=>[r(" Kirjaudu ")]),_:1})]))],64))}},ba=he(fa,[["__scopeId","data-v-95702c33"]]);export{ba as default};
