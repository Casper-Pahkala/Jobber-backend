import{$ as ke,a1 as Ve,a0 as he,r as u,c as te,a3 as d,a4 as g,a6 as O,a7 as b,a5 as t,ao as x,a8 as w,a9 as r,t as l,Q as v,Z as k,ai as _e,aa as s,ae as D,ac as G,V as be,aH as xe,ag as we,ah as Te,aE as T,ab as $,N as je,bL as Ce,aI as Se,an as Ue,aj as Ie,ak as De}from"./index-f078a329.js";import{a as Q,b as M,c as A,V as Re}from"./VWindowItem-70838227.js";import{a as Fe}from"./VDivider-1253dc03.js";import{g as Le,f as $e}from"./VForm-4fd562c1.js";import{b as Me,V as Ae,a as Je}from"./VLocaleProvider-1833f056.js";import{a as We}from"./VTextarea-0dad0855.js";const i=R=>(Ie("data-v-7a26fc9b"),R=R(),De(),R),He=i(()=>s("h1",{class:"pb-5"},"Luo listaus",-1)),Pe=i(()=>s("div",{class:"title"},[s("h2",null,"Kuvat")],-1)),Ee={class:"content"},Ke=i(()=>s("canvas",{id:"imageCanvas",style:{display:"none"}},null,-1)),Be={style:{display:"flex","flex-direction":"column","align-items":"center",gap:"10px"}},Ne={class:"actions"},ze=i(()=>s("div",{class:"title"},[s("h2",null,"Tiedot")],-1)),qe={class:"content"},Ye=i(()=>s("h4",{class:"pl-1"},"Mikä on työn otsikko? *",-1)),Oe=i(()=>s("span",{class:"pl-1"},"Esim. Lastenhoitaja tai Nurmikonleikkaaja",-1)),Ge=i(()=>s("h4",{class:"pl-1"},"Mikä on kohde alueesi? *",-1)),Qe=i(()=>s("span",{class:"pl-1"},"Esim. Suomi tai Helsinki, Suomi",-1)),Xe={class:"actions"},Ze=i(()=>s("div",{class:"title"},[s("h2",null,"Tiedot")],-1)),ea={class:"content"},aa=i(()=>s("h4",{class:"pl-1"},"Milloin työt alkavat? *",-1)),la=i(()=>s("h4",{class:"pl-1"},"Mikä on työsopimuksen tyyppi?",-1)),ta=i(()=>s("h4",{class:"pl-1"},"Mikä on työn kesto?",-1)),sa=i(()=>s("span",{class:"pl-1"},"Jätä tyhjäksi jos ei tiedossa",-1)),oa=i(()=>s("h4",{class:"pl-1"},"Mikä on palkan tyyppi?",-1)),na=i(()=>s("span",{class:"pl-1"},"Jätä tyhjäksi jos ei tiedossa",-1)),ua=i(()=>s("h4",{class:"pl-1"},"Paljonko tunteja viikossa?",-1)),ia=i(()=>s("span",{class:"pl-1"},"Jätä tyhjäksi jos ei tiedossa",-1)),da=i(()=>s("h4",{class:"pl-1"},"Mikä on palkan tyyppi?",-1)),ra=i(()=>s("span",{class:"pl-1"},"Jätä tyhjäksi jos ei tiedossa",-1)),ma={class:"actions"},pa={key:1,class:"login-container"},ca={__name:"AddJob",setup(R){const se=Ve(),m=he(),c=u([]),J=u([]),X=u(null),W=u("one"),oe=["Sopimuksen mukaan","Tarkka päivämäärä"],ne=["Keikkatyö","Vakituinen","Toistaiseksi voimassa oleva"],Z=["Tuntipalkka","Urakkapalkka"],ee=["Tuntipalkka","Kuukausipalkka"],H=u(""),P=u(""),V=u(""),E=u(!1),K=u([]),B=u(""),j=u(!1),F=u(0),L=u(null),ae=te(()=>L.value?_e(L.value).format("DD.MM.YYYY"):null),N=u(null),C=u(0),z=u(null),f=u(0),q=u(null),S=u(null),ue=te(()=>{if(c.value.length===0)return!0;let o=!0;return c.value.forEach(e=>{e.ready||(o=!1)}),o?(console.log("uploaded all"),!0):!1});function ie(){j.value=!1,L.value=N.value}function de(){X.value.click()}function re(o){c.value=c.value.filter((e,a)=>a!==o),J.value=J.value.filter((e,a)=>a!==o)}function me(o){const e=o.target.files[0];if(e)if(e.type.startsWith("image/")&&!e.type.startsWith("image/gif")){var a=new FileReader;a.onload=function(n){const p=new Image;p.onload=()=>{let h=p.width,_=p.height;(h>1920||_>1080)&&(h/1920>_/1080?(_*=1920/h,h=1920):(h*=1080/_,_=1080));const I=document.getElementById("imageCanvas"),fe=I.getContext("2d");I.width=h,I.height=_,fe.drawImage(p,0,0,h,_);const ge=I.toDataURL("image/jpeg",.8);c.value.push({image:ge,progress:10,ready:!1}),I.toBlob(le=>{const ye=new File([le],e.name,{type:"image/jpeg"});J.value.push(ye),pe(le)},"image/jpeg",.8)},p.src=n.target.result},a.readAsDataURL(e)}else m.snackbarText="Valitse kuva tiedostotyyppi",m.snackbarColor="red-darken-2",m.snackbar=!0}function pe(o){const e=new XMLHttpRequest,a=new FormData;a.append("image",o);let n=c.value.length-1;n<0&&(n=0);const p=c.value[n];e.upload.addEventListener("progress",y=>{if(y.lengthComputable){const Y=y.loaded/y.total*100;p.progress=Y,Y>=100&&setTimeout(()=>{p.ready=!0},1e3)}}),e.open("POST",`${m.url}/api/jobs/upload-image.json`,!0),e.onreadystatechange=function(){if(e.readyState==4&&e.status==200)try{const y=JSON.parse(e.responseText).data;p.id=y.image_id,console.log(p)}catch(y){console.error("Error parsing response:",y)}},e.send(a)}function U(o){W.value=o}function ce(){let o=null;K.value=[],setTimeout(()=>{o=V.value},100),setTimeout(()=>{V.value&&V.value.length>0&&o===V.value&&(E.value=!0,m.getAddressSuggestions(V.value).then(e=>{K.value=e.suggestions,E.value=!1}))},500)}function ve(){m.loading=!0;let o={title:H.value,area:P.value,description:B.value,images:c.value.map(e=>e.id),date:F.value===1?L.value:null,contract_type:C.value,salary_type:f.value,salary:S.value};C.value===0?o.hours=z.value:o.hours=q.value,m.addJob(o).then(e=>{se.replace("/jobs/"+e.job_id)}).catch(()=>{})}return m.user||(m.loginDialogShowing=!0),(o,e)=>(d(),g(k,null,[O(m).user?(d(),b(x,{key:0,class:"add-container pa-10"},{default:t(()=>[He,l(Re,{modelValue:W.value,"onUpdate:modelValue":e[23]||(e[23]=a=>W.value=a),class:"main-window"},{default:t(()=>[l(Q,{value:"one",class:"window"},{default:t(()=>[Pe,s("div",Ee,[l(Fe,{justify:"center",align:"center",class:"images mt-10"},{default:t(()=>[(d(!0),g(k,null,D(c.value,(a,n)=>(d(),b(G,{key:n,elevation:"8",width:"180"},{default:t(()=>[l(be,{src:a?a.image:"#",alt:"your image",cover:"","aspect-ratio":"1"},null,8,["src"]),a.ready?(d(),b(v,{key:0,class:"close-btn",icon:"mdi-delete",elevation:"8",size:"35",onClick:p=>re(n)},null,8,["onClick"])):w("",!0),a.ready?w("",!0):(d(),b(xe,{key:1,class:"progress-bar","model-value":a.progress,color:"primary"},null,8,["model-value"]))]),_:2},1024))),128)),Ke,c.value.length<=9?(d(),b(G,{key:0,elevation:"8",width:"180",height:"180"},{default:t(()=>[s("input",{type:"file",ref_key:"fileInput",ref:X,onChange:me,style:{display:"none"},id:"customFileInput"},null,544),l(v,{onClick:de,icon:"mdi-plus",flat:"",id:"add-img-btn",class:"text-none"},{default:t(()=>[s("div",Be,[l(we,{style:{"font-size":"35px"}}),r(" Lisää kuva ")])]),_:1})]),_:1})):w("",!0)]),_:1})]),s("div",Ne,[l(v,{color:"primary",class:"text-none","append-icon":"mdi-chevron-right",style:{float:"right"},onClick:e[0]||(e[0]=a=>U("two")),disabled:!ue.value},{default:t(()=>[r("Seuraava")]),_:1},8,["disabled"])])]),_:1}),l(Q,{value:"two",class:"window"},{default:t(()=>[ze,s("div",qe,[l(Le,{onSubmit:e[6]||(e[6]=Te(a=>U("three"),["prevent"])),ref:"jobForm"},{default:t(()=>[l(x,null,{default:t(()=>[Ye,Oe,l(T,{modelValue:H.value,"onUpdate:modelValue":e[1]||(e[1]=a=>H.value=a),label:"Työn otsikko",rules:o.jobTitleRules,required:""},null,8,["modelValue","rules"])]),_:1}),l(x,null,{default:t(()=>[Ge,Qe,l(Me,{label:"Alue",items:K.value,"onUpdate:search":[e[2]||(e[2]=a=>ce()),e[3]||(e[3]=a=>V.value=a)],"hide-no-data":"",search:V.value,modelValue:P.value,"onUpdate:modelValue":e[4]||(e[4]=a=>P.value=a),"auto-select-first":"",clearable:"",loading:E.value},null,8,["items","search","modelValue","loading"])]),_:1}),l(x,null,{default:t(()=>[l(We,{label:"Kuvaus",rules:o.descriptionRules,required:"",modelValue:B.value,"onUpdate:modelValue":e[5]||(e[5]=a=>B.value=a),"no-resize":""},null,8,["rules","modelValue"])]),_:1})]),_:1},512)]),s("div",Xe,[l(v,{onClick:e[7]||(e[7]=a=>U("one")),class:"text-none"},{default:t(()=>[r("Takaisin")]),_:1}),l(v,{color:"primary",type:"submit",class:"text-none",onClick:e[8]||(e[8]=a=>U("three")),"append-icon":"mdi-chevron-right"},{default:t(()=>[r("Seuraava")]),_:1})])]),_:1}),l(Q,{value:"three",class:"window"},{default:t(()=>[Ze,s("div",ea,[l(x,null,{default:t(()=>[aa,l(M,{mandatory:"","selected-class":"text-primary",column:"",modelValue:F.value,"onUpdate:modelValue":e[9]||(e[9]=a=>F.value=a)},{default:t(()=>[(d(),g(k,null,D(oe,(a,n)=>l(A,{key:n},{default:t(()=>[r($(a),1)]),_:2},1024)),64))]),_:1},8,["modelValue"]),F.value==1?(d(),b($e,{key:0,modelValue:j.value,"onUpdate:modelValue":e[14]||(e[14]=a=>j.value=a),"max-width":"400"},{activator:t(({on:a})=>[l(T,je({modelValue:ae.value,"onUpdate:modelValue":e[10]||(e[10]=n=>ae.value=n),label:"Päivä",readonly:""},Ce(a),{"onUpdate:focused":e[11]||(e[11]=n=>j.value=!0),rules:o.jobDateRules,required:""}),null,16,["modelValue","rules"])]),default:t(()=>[l(G,null,{default:t(()=>[l(Se,null,{default:t(()=>[l(Ae,{locale:"fi"},{default:t(()=>[l(Je,{modelValue:N.value,"onUpdate:modelValue":e[12]||(e[12]=a=>N.value=a),"hide-actions":"",min:o.minDate,title:"Valitse päivämäärä"},null,8,["modelValue","min"])]),_:1})]),_:1}),l(Ue,{style:{direction:"rtl"}},{default:t(()=>[l(v,{flat:"",onClick:ie},{default:t(()=>[r("OK")]),_:1}),l(v,{flat:"",onClick:e[13]||(e[13]=a=>j.value=!1)},{default:t(()=>[r("Peruuta")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])):w("",!0)]),_:1}),l(x,null,{default:t(()=>[la,l(M,{mandatory:"","selected-class":"text-primary",column:"",modelValue:C.value,"onUpdate:modelValue":e[15]||(e[15]=a=>C.value=a)},{default:t(()=>[(d(),g(k,null,D(ne,(a,n)=>l(A,{key:n},{default:t(()=>[r($(a),1)]),_:2},1024)),64))]),_:1},8,["modelValue"]),C.value==0?(d(),g(k,{key:0},[ta,sa,l(T,{label:"kesto",suffix:"h",type:"number",modelValue:z.value,"onUpdate:modelValue":[e[16]||(e[16]=a=>z.value=a),o.estimatedTimeUpdated],min:"0",rules:o.numberRules},null,8,["modelValue","onUpdate:modelValue","rules"]),oa,na,l(M,{mandatory:"","selected-class":"text-primary",column:"",modelValue:f.value,"onUpdate:modelValue":e[17]||(e[17]=a=>f.value=a)},{default:t(()=>[(d(),g(k,null,D(Z,(a,n)=>l(A,{key:n},{default:t(()=>[r($(a),1)]),_:2},1024)),64))]),_:1},8,["modelValue"]),l(T,{label:Z[f.value],suffix:f.value==0?"€/h":"€",type:"number",modelValue:S.value,"onUpdate:modelValue":e[18]||(e[18]=a=>S.value=a),min:"0",rules:o.numberRules},null,8,["label","suffix","modelValue","rules"])],64)):(d(),g(k,{key:1},[ua,ia,l(T,{label:"Tunteja viikossa",suffix:"h",type:"number",modelValue:q.value,"onUpdate:modelValue":e[19]||(e[19]=a=>q.value=a),min:"0",rules:o.numberRules},null,8,["modelValue","rules"]),da,ra,l(M,{mandatory:"","selected-class":"text-primary",column:"",modelValue:f.value,"onUpdate:modelValue":e[20]||(e[20]=a=>f.value=a)},{default:t(()=>[(d(),g(k,null,D(ee,(a,n)=>l(A,{key:n},{default:t(()=>[r($(a),1)]),_:2},1024)),64))]),_:1},8,["modelValue"]),l(T,{label:ee[f.value],suffix:f.value==0?"€/h":"€/kk",type:"number",modelValue:S.value,"onUpdate:modelValue":e[21]||(e[21]=a=>S.value=a),min:"0",rules:o.numberRules},null,8,["label","suffix","modelValue","rules"])],64))]),_:1})]),s("div",ma,[l(v,{onClick:e[22]||(e[22]=a=>U("two")),class:"text-none"},{default:t(()=>[r("Takaisin")]),_:1}),l(v,{color:"primary",class:"text-none","append-icon":"mdi-chevron-right",style:{float:"right"},onClick:ve},{default:t(()=>[r("Luo listaus")]),_:1})])]),_:1})]),_:1},8,["modelValue"])]),_:1})):w("",!0),O(m).user?w("",!0):(d(),g("div",pa,[r(" Kirjaudu sisään niin pääset lisäämään listauksen "),l(v,{class:"mt-7",size:"large",color:"primary",onClick:e[24]||(e[24]=a=>O(m).loginDialogShowing=!0)},{default:t(()=>[r(" Kirjaudu ")]),_:1})]))],64))}},ha=ke(ca,[["__scopeId","data-v-7a26fc9b"]]);export{ha as default};
