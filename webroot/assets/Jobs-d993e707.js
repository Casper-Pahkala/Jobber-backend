import{r as A,bO as Q,p as U,az as C,v as W,m as X,aA as Z,w as H,x as Y,bP as ee,l as ae,y as te,aE as le,n as ne,L as ie,aL as se,F as oe,E as re,T as ue,s as ve,G as D,u as ce,c as g,bQ as R,A as m,q as de,t as r,Q as L,N as I,bR as M,_ as q,a8 as fe,aa as ge,ab as be,a9 as me,ad as P,ae as S,af as pe,ai as B,ak as j,ag as $,Z as ye,aq as _e,aj as he,ah as Pe,at as Le,au as ke}from"./index-4808f960.js";import{J as xe}from"./JobCard-609dfeb3.js";import"./VSkeletonLoader-4d43539e.js";import"./VMenu-74aa5951.js";import"./VDivider-5c3acf2f.js";import"./VHover-d1f6fb46.js";function Ve(){const e=A([]);Q(()=>e.value=[]);function p(u,y){e.value[y]=u}return{refs:e,updateRef:p}}const Ie=U({activeColor:String,start:{type:[Number,String],default:1},modelValue:{type:Number,default:e=>e.start},disabled:Boolean,length:{type:[Number,String],default:1,validator:e=>e%1===0},totalVisible:[Number,String],firstIcon:{type:C,default:"$first"},prevIcon:{type:C,default:"$prev"},nextIcon:{type:C,default:"$next"},lastIcon:{type:C,default:"$last"},ariaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.root"},pageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.page"},currentPageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.currentPage"},firstAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.first"},previousAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.previous"},nextAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.next"},lastAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.last"},ellipsis:{type:String,default:"..."},showFirstLastPage:Boolean,...W(),...X(),...Z(),...H(),...Y(),...ee(),...ae({tag:"nav"}),...te(),...le({variant:"text"})},"VPagination"),Se=ne()({name:"VPagination",props:Ie(),emits:{"update:modelValue":e=>!0,first:e=>!0,prev:e=>!0,next:e=>!0,last:e=>!0},setup(e,p){let{slots:u,emit:y}=p;const t=ie(e,"modelValue"),{t:o,n:_}=se(),{isRtl:h}=oe(),{themeClasses:w}=re(e),{width:T}=ue(),b=ve(-1);D(void 0,{scoped:!0});const{resizeRef:k}=ce(a=>{if(!a.length)return;const{target:l,contentRect:s}=a[0],v=l.querySelector(".v-pagination__list > *");if(!v)return;const c=s.width,V=v.offsetWidth+parseFloat(getComputedStyle(v).marginRight)*2;b.value=F(c,V)}),n=g(()=>parseInt(e.length,10)),i=g(()=>parseInt(e.start,10)),d=g(()=>e.totalVisible!=null?parseInt(e.totalVisible,10):b.value>=0?b.value:F(T.value,58));function F(a,l){const s=e.showFirstLastPage?5:3;return Math.max(0,Math.floor(+((a-l*s)/l).toFixed(2)))}const J=g(()=>{if(n.value<=0||isNaN(n.value)||n.value>Number.MAX_SAFE_INTEGER)return[];if(d.value<=0)return[];if(d.value===1)return[t.value];if(n.value<=d.value)return R(n.value,i.value);const a=d.value%2===0,l=a?d.value/2:Math.floor(d.value/2),s=a?l:l+1,v=n.value-l;if(s-t.value>=0)return[...R(Math.max(1,d.value-1),i.value),e.ellipsis,n.value];if(t.value-v>=(a?1:0)){const c=d.value-1,V=n.value-c+i.value;return[i.value,e.ellipsis,...R(c,V)]}else{const c=Math.max(1,d.value-3),V=c===1?t.value:t.value-Math.ceil(c/2)+i.value;return[i.value,e.ellipsis,...R(c,V),e.ellipsis,n.value]}});function x(a,l,s){a.preventDefault(),t.value=l,s&&y(s,l)}const{refs:z,updateRef:O}=Ve();D({VPaginationBtn:{color:m(e,"color"),border:m(e,"border"),density:m(e,"density"),size:m(e,"size"),variant:m(e,"variant"),rounded:m(e,"rounded"),elevation:m(e,"elevation")}});const G=g(()=>J.value.map((a,l)=>{const s=v=>O(v,l);if(typeof a=="string")return{isActive:!1,key:`ellipsis-${l}`,page:a,props:{ref:s,ellipsis:!0,icon:!0,disabled:!0}};{const v=a===t.value;return{isActive:v,key:a,page:_(a),props:{ref:s,ellipsis:!1,icon:!0,disabled:!!e.disabled||+e.length<2,color:v?e.activeColor:e.color,ariaCurrent:v,ariaLabel:o(v?e.currentPageAriaLabel:e.pageAriaLabel,a),onClick:c=>x(c,a)}}}})),f=g(()=>{const a=!!e.disabled||t.value<=i.value,l=!!e.disabled||t.value>=i.value+n.value-1;return{first:e.showFirstLastPage?{icon:h.value?e.lastIcon:e.firstIcon,onClick:s=>x(s,i.value,"first"),disabled:a,ariaLabel:o(e.firstAriaLabel),ariaDisabled:a}:void 0,prev:{icon:h.value?e.nextIcon:e.prevIcon,onClick:s=>x(s,t.value-1,"prev"),disabled:a,ariaLabel:o(e.previousAriaLabel),ariaDisabled:a},next:{icon:h.value?e.prevIcon:e.nextIcon,onClick:s=>x(s,t.value+1,"next"),disabled:l,ariaLabel:o(e.nextAriaLabel),ariaDisabled:l},last:e.showFirstLastPage?{icon:h.value?e.firstIcon:e.lastIcon,onClick:s=>x(s,i.value+n.value-1,"last"),disabled:l,ariaLabel:o(e.lastAriaLabel),ariaDisabled:l}:void 0}});function N(){var l;const a=t.value-i.value;(l=z.value[a])==null||l.$el.focus()}function K(a){a.key===M.left&&!e.disabled&&t.value>+e.start?(t.value=t.value-1,q(N)):a.key===M.right&&!e.disabled&&t.value<i.value+n.value-1&&(t.value=t.value+1,q(N))}return de(()=>r(e.tag,{ref:k,class:["v-pagination",w.value,e.class],style:e.style,role:"navigation","aria-label":o(e.ariaLabel),onKeydown:K,"data-test":"v-pagination-root"},{default:()=>[r("ul",{class:"v-pagination__list"},[e.showFirstLastPage&&r("li",{key:"first",class:"v-pagination__first","data-test":"v-pagination-first"},[u.first?u.first(f.value.first):r(L,I({_as:"VPaginationBtn"},f.value.first),null)]),r("li",{key:"prev",class:"v-pagination__prev","data-test":"v-pagination-prev"},[u.prev?u.prev(f.value.prev):r(L,I({_as:"VPaginationBtn"},f.value.prev),null)]),G.value.map((a,l)=>r("li",{key:a.key,class:["v-pagination__item",{"v-pagination__item--is-active":a.isActive}],"data-test":"v-pagination-item"},[u.item?u.item(a):r(L,I({_as:"VPaginationBtn"},a.props),{default:()=>[a.page]})])),r("li",{key:"next",class:"v-pagination__next","data-test":"v-pagination-next"},[u.next?u.next(f.value.next):r(L,I({_as:"VPaginationBtn"},f.value.next),null)]),e.showFirstLastPage&&r("li",{key:"last",class:"v-pagination__last","data-test":"v-pagination-last"},[u.last?u.last(f.value.last):r(L,I({_as:"VPaginationBtn"},f.value.last),null)])])]})),{}}}),E=e=>(Le("data-v-095a4f7a"),e=e(),ke(),e),Ae={class:"content"},we=E(()=>j("div",{class:"top-layout"},null,-1)),Ce={key:0,class:"loading-container"},Re={key:0,class:"error-container"},Be=E(()=>j("span",null,"Töiden haussa tapahtui virhe",-1)),$e={id:"jobs-container"},Te={key:1,class:"pagination-container"},je={__name:"Jobs",setup(e){window.scrollTo(0,0);const p=ge(),y=be().query,t=me(),o=A(!1),_=A(!1);o.value=!0,t.jobParams.page=y.p??1,t.jobParams.limit=y.l??10;const h=g(()=>Math.ceil(t.jobParams.totalCount/t.jobParams.limit));A(!1);const w=g(()=>({p:t.jobParams.page,l:t.jobParams.limit}));A(null),p.replace({query:w.value});function T(){window.scrollTo(0,0),p.replace({query:w.value}),b()}function b(){_.value=!1,o.value=!0;const k=300;let n=!1,i=!1;setTimeout(()=>{n=!0,i&&(o.value=!1)},k),t.fetchJobs().then(()=>{i=!0,n&&(o.value=!1)}).catch(()=>{t.errorToast("Töiden haussa tapahtui virhe"),o.value=!1,_.value=!0})}return b(),(k,n)=>(P(),S("div",Ae,[we,_.value?(P(),S("div",Ce,[_.value?(P(),S("div",Re,[Be,r(L,{"prepend-icon":"mdi-refresh",onClick:n[0]||(n[0]=i=>b())},{default:pe(()=>[he(" Päivitä työt ")]),_:1})])):B("",!0)])):B("",!0),j("div",$e,[!o.value||$(t).jobs.length>0?(P(!0),S(ye,{key:0},_e($(t).jobs,i=>(P(),Pe(xe,{key:i.id,job:i},null,8,["job"]))),128)):B("",!0)]),o.value?B("",!0):(P(),S("div",Te,[r(Se,{modelValue:$(t).jobParams.page,"onUpdate:modelValue":[n[1]||(n[1]=i=>$(t).jobParams.page=i),n[2]||(n[2]=i=>T())],length:h.value,"total-visible":7},null,8,["modelValue","length"])]))]))}},Je=fe(je,[["__scopeId","data-v-095a4f7a"]]);export{Je as default};
